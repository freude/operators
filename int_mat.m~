clear all

n_orb=2;

c = Conf(n_orb,4);

a=OperatorFermion(1:2*n_orb);

E=[1 1];

Hkin=zeros(c.Nconf,c.Nconf);
Hh=zeros(c.Nconf,c.Nconf);
Hc=zeros(c.Nconf,c.Nconf);

for j1=1:c.Nconf
    for j2=1:c.Nconf
        %-------------------------------------------------
        for j=1:4
            
            jt=mod(j,2);
            Hkin(j1,j2)=Hkin(j1,j2)+c.overlap(j1,a(j).*a(j)*c.distr(j2,:));
            
            for jj=1:4
                
                jjt=mod(jj,2);
                
                if ((jj~=j)&&(jt==jjt))
                    Hh(j1,j2)=Hh(j1,j2)+c.overlap(j1,a(j).*a(jj)*c.distr(j2,:));
                end;
                
                for jjj=1:4
                    jjjt=mod(jjj,2);
                    for jjjj=1:4
                        jjjjt=mod(jjjj,2);
                        if ((jj~=j)&&(jjjj~=jjj))
                            Hc(j1,j2)=Hc(j1,j2)+c.overlap(j1,a(jjjj).*a(jjj).*a(jj)*a(j)*c.distr(j2,:));
                        end;
                    end;
                end;
                
            end;
            
        end;
        %-------------------------------------------------        
    end;
end;